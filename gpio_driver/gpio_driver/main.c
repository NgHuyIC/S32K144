/**
* @file    main.c
* @brief   Main function for GPIO demo
* @details This file contains the main function that initializes GPIO and toggles a pin on Port D.
*/

/*==================================================================================================
*                                        INCLUDE FILES
==================================================================================================*/
#include "Gpio.h"
#include "PORT_Register.h"

/*==================================================================================================
*                          LOCAL TYPEDEFS (STRUCTURES, UNIONS, ENUMS)
==================================================================================================*/

/*==================================================================================================
*                                       LOCAL MACROS
==================================================================================================*/

/**
* @brief   Macros to enable PCC for various ports
*/
#define PCC_PORTA      (*(unsigned int*)(0x40065000u + 0x124))
#define PCC_PORTB      (*(unsigned int*)(0x40065000u + 0x128))
#define PCC_PORTC      (*(unsigned int*)(0x40065000u + 0x12C))
#define PCC_PORTD      (*(unsigned int*)(0x40065000u + 0x130))
#define PCC_PORTE      (*(unsigned int*)(0x40065000u + 0x134))

/*==================================================================================================
*                                      LOCAL CONSTANTS
==================================================================================================*/

/*==================================================================================================
*                                      LOCAL VARIABLES
==================================================================================================*/

/*==================================================================================================
*                                      GLOBAL CONSTANTS
==================================================================================================*/

/*==================================================================================================
*                                      GLOBAL VARIABLES
==================================================================================================*/

/*==================================================================================================
*                                   LOCAL FUNCTION PROTOTYPES
==================================================================================================*/

/*==================================================================================================
*                                       LOCAL FUNCTIONS
==================================================================================================*/

/*==================================================================================================
*                                       GLOBAL FUNCTIONS
==================================================================================================*/

/**
* @brief   Main function
* @details Initializes GPIO and toggles a pin on Port D
*
* @return  int
*/
int main()
{
    // Enable clock for Port D using PCC
    PCC_PORTD |= (1U << 30U);

    // Configure Pin 0 of Port D for GPIO functionality
    PORTD->PCR[0] |= (1U << 8U);

    // Initialize GPIO on GPIOD, Pin 0 as output
    Gpio_Init(GPIOD, 0, 1);

    // Main loop: Toggle GPIO Pin 0 of GPIOD
    while (1)
    {
        // Delay loop
        for (int i = 0; i < 100000; i++)
            ;
        // Toggle GPIO Pin
        GPIO_ToggleOutputPin(GPIOD, 0);
    }

    return 0;
}
